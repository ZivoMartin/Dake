FROM rust:1.83-alpine AS builder

RUN apk add --no-cache git musl-dev openssl-dev pkgconfig

RUN rustup toolchain install nightly && rustup default nightly

WORKDIR /Dake
RUN git clone https://github.com/ZivoMartin/Dake.git .
RUN cargo build --release

FROM alpine:latest
COPY --from=builder /Dake/target/release/dake /usr/local/bin/dake

ENTRYPOINT ["/bin/sh", "-c", "sleep infinity"]
